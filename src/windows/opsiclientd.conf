; = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =
; =     configuration file for opsiclientd                              =
; = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =


; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
; -     global settings                                                 -
; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
[global]

# Location of the log file.
log_file = c:\\tmp\\opsiclientd.log

# Set the log (verbosity) level
# (0 <= log level <= 9)
# 0: nothing, 1: essential, 2: critical, 3: errors, 4: warnings, 5: notices
# 6: infos, 7: debug messages, 8: more debug messages, 9: passwords
log_level = 4

# Client id.
host_id = 

# Opsi host key.
opsi_host_key = 

# On every daemon startup the user login gets blocked
# If the gui starts up and no events are being processed the login gets unblocked
# If no gui startup is noticed after <wait_for_gui_timeout> the login gets unblocked
# Set to 0 to wait forever
wait_for_gui_timeout = 120

# Application to run while waiting for gui
wait_for_gui_application =

# Application to run while blocking login
block_login_notifier = %global.base_dir%\\notifier.exe -s notifier\\block_login.ini

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
; -     config service settings                                         -
; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
[config_service]
# Service url.
# http(s)://<opsi config server address>:<port>/rpc
url = https://opsi.uib.local:4447/rpc

# Conection timeout.
connection_timeout = 30

# The time in seconds after which the user can cancel the connection establishment
user_cancellable_after = 30

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
; -     depot server settings                                           -
; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
[depot_server]

# Depot server id
depot_id =

# Depot url.
# smb://<depot address>/<share name>/<path to products>
url =

# Local depot drive
drive =

# Username that is used for network connection [domain\]<username>
username = pcpatch

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
; -     cache service settings                                          -
; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
[cache_service]
# Maximum product cache size in bytes
product_cache_max_size = 5000000000
backend_manager_config = %global.base_dir%\\opsiclientd\\backendManager.d

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
; -     control server settings                                         -
; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
[control_server]

# The network interfaces to bind to.
# This must be the IP address of an network interface.
# Use 0.0.0.0 to listen to all interfaces
interface = 0.0.0.0

# The port where opsiclientd will listen for HTTPS rpc requests.
port = 4441

# The location of the server certificate.
ssl_server_cert_file = %global.base_dir%\\opsiclientd\\opsiclientd.pem

# The location of the server private key
ssl_server_key_file = %global.base_dir%\\opsiclientd\\opsiclientd.pem

# The location of the static files
static_dir = %global.base_dir%\\opsiclientd\\static_html

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
; -     notification server settings                                    -
; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
[notification_server]

# The network interfaces to bind to.
# This must be the IP address of an network interface.
# Use 0.0.0.0 to listen to all interfaces
interface = 127.0.0.1

# The first port where opsiclientd will listen for notification clients.
start_port = 44000

# Port for popup notification server
popup_port = 45000

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
; -     opsiclientd notifier settings                                   -
; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
[opsiclientd_notifier]

# Notifier application command
command = %global.base_dir%\\notifier.exe -p %port%

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
; -     opsiclientd rpc tool settings                                   -
; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
[opsiclientd_rpc]

# RPC tool command
command = %global.base_dir%\\opsiclientd_rpc.exe "%global.host_id%" "%global.opsi_host_key%" "%control_server.port%"

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
; -     action processor settings                                       -
; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
[action_processor]
# Locations of action processor
local_dir = %global.base_dir%\\opsi-winst
remote_dir = \\install\\opsi-winst\\files\\opsi-winst
filename = winst32.exe
# Action processor command
command = "%action_processor.local_dir%\\%action_processor.filename%" /opsiservice "%service_url%" /clientid %global.host_id% /username %global.host_id% /password %global.opsi_host_key%

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
; -     events                                                          -
; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
[event_daemon_startup]
type = daemon startup
active = false

[event_daemon_shutdown]
type = daemon shutdown
active = false

[event_gui_startup]
type = gui startup
message = Starting to process product actions. Attention: the computer may restart. Please save all unsaved data now.
user_cancelable = 0
block_login = true
lock_workstation = false
logoff_current_user = false
get_config_from_service = true
update_config_file = true
write_log_to_service = true
update_action_processor = true
cache_products = false
cache_max_bandwidth = 0
sync_config = false
requires_cached_products = false
use_cached_config = false
event_notifier_command = %opsiclientd_notifier.command% -s notifier\\event.ini
event_notifier_desktop = current
action_notifier_command = %opsiclientd_notifier.command% -s notifier\\action.ini
action_notifier_desktop = current
action_processor_command = %action_processor.command%
action_processor_desktop = current

[event_on_demand]
type = custom
message = Starting to process product actions. Attention: the computer may restart. Please save all unsaved data now.
user_cancelable = 0
block_login = true
lock_workstation = false
logoff_current_user = false
get_config_from_service = true
update_config_file = true
write_log_to_service = true
update_action_processor = true
cache_products = false
cache_max_bandwidth = 0
sync_config = false
requires_cached_products = false
use_cached_config = false
shutdown_warning_time = 300
shutdown_user_cancelable = 0
shutdown_warning_repetion_time = 3600
event_notifier_command = %opsiclientd_notifier.command% -s notifier\\event.ini
event_notifier_desktop = current
action_notifier_command = %opsiclientd_notifier.command% -s notifier\\action.ini
action_notifier_desktop = current
action_processor_command = %action_processor.command%
action_processor_desktop = current
shutdown_notifier_command = %opsiclientd_notifier.command% -s notifier\\shutdown.ini
shutdown_notifier_desktop = current

[event_vpn_startup]
type = custom
active = false
wql = SELECT * FROM __InstanceModificationEvent WITHIN 2 WHERE TargetInstance ISA 'Win32_NetworkAdapter' AND TargetInstance.Name = "TAP-Win32 Adapter V9" AND TargetInstance.NetConnectionStatus = 2
message = Opsi will start software and hardware inventory on this computer. You can continue your work in the meantime.
get_config_from_service = true
update_config_file = true
write_log_to_service = true
warning_time = 20
service_options = { "actionProcessingFilter": { "productIds": ["hwaudit", "swaudit"] } }
cache_products = false
cache_max_bandwidth = 0
event_notifier_command = %opsiclientd_notifier.command% -s notifier\\event.ini
event_notifier_desktop = current
action_notifier_command = %opsiclientd_notifier.command% -s notifier\\action.ini
action_notifier_desktop = current
action_processor_command = %action_processor.command% /service_options "%event_vpn_startup.service_options%"
action_processor_desktop = current

[event_user_login]
type = user login
active = false
message = Starting to process user login actions.
user_cancelable = 0
block_login = false
lock_workstation = false
logoff_current_user = false
process_shutdown_requests = false
get_config_from_service = false
update_config_file = false
write_log_to_service = false
update_action_processor = false
notification_delay = 0
cache_products = false
cache_max_bandwidth = 0
sync_config = false
requires_cached_products = false
use_cached_config = false
event_notifier_command = %opsiclientd_notifier.command% -s notifier\\event.ini
event_notifier_desktop = current
action_type = login
action_notifier_command = %opsiclientd_notifier.command% -s notifier\\userlogin.ini
action_notifier_desktop = current
action_processor_command = %action_processor.command% /usercontext %event.user%
action_processor_desktop = current
action_processor_timeout = 300

