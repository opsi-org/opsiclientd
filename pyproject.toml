[tool.poetry]
name = "opsiclientd"
version = "4.2.0.157"
description = "opsi client daemon. The service running on opsi clients."
maintainers = ["uib GmbH <info@uib.de>"]
authors = ["uib GmbH <info@uib.de>"]
homepage = "https://www.opsi.org"
license = "AGPL-3.0"
include = [
    "run-opsiclientd",
    "opsiclientd_data/**/*"
]

[[tool.poetry.source]]
name = "uibpypi"
url = "https://pypi.uib.gmbh/simple"
priority = "primary"


[[tool.poetry.source]]
name = "PyPI"
priority = "primary"

[tool.poetry.dependencies]
python = "^3.11,<3.12"
autobahn = "^22.4"
# cryptography pinned (AttributeError: module 'lib' has no attribute 'OpenSSL_add_all_algorithms')
cryptography = "38.0.4"
distro = {platform = "linux", version = "^1.5"}
macholib = "^1.14"
msgpack = "^1.0"
netifaces = "^0.11"
pyelftools = "^0.29"
python-opsi = "^4.3.0.13"
python-opsi-common = "^4.3.0"
#python-opsi-common = {path = "python-opsi-common", develop = true}
#websocket-client = "^1.5"
websocket-client = { git = "https://github.com/j-a-n/websocket-client.git", branch = "fix-get_proxy_info-for-https" }
# Pin pywin32 to 303. 304 and 305 will result in the following error on startup:
# ImportError: DLL load failed while importing pythoncom
pywin32 = {platform = "win32", version = ">=303,<304"}
pywinpty = {platform = "win32", version = "^2.0"}
wmi = {platform = "win32", version = "^1.5"}
zeroconf = "^0.47"

[tool.poetry.dev-dependencies]
flake8 = "^6.0"
isort = "^5.10.1"
macholib = {version = "^1.14", platform = "darwin"}
mock = "^5.0"
mypy = "^1.4"
pefile = {version = "^2023.2", platform = "win32"}
pylint = "^2.5"
pytest = "^7.1"
pytest-cov = "^4.0"
pywin32-ctypes = {version = "^0.2", platform = "win32"}
requests = "^2.25"
tan = "^22.8"
pyinstaller = "^5.2"

[tool.poetry.scripts]
opsiclientd = "opsiclientd.__main__:opsiclientd"
opsiclientd_rpc = "opsiclientd.__main__:opsiclientd_rpc"
action_processor_starter = "opsiclientd.__main__:action_processor_starter"

[tool.black]
line-length = 140
target-version = ['py311']
use-tabs = true

[tool.isort]
profile = "black"
indent = "\t"

[build-system]
requires = ["poetry>=0.12"]
build-backend = "poetry.masonry.api"

